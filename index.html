<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Pass Prediction Engine</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  margin: auto;
  background: #ffffff;
  padding: 20px;
  min-height: 100vh;
}
h1, h2 {
  text-align: center;
}
.hidden {
  display: none;
}
input, button {
  padding: 10px;
  margin: 5px 0;
  width: 100%;
  font-size: 16px;
}
.option {
  border: 1px solid #ccc;
  padding: 10px;
  margin-top: 8px;
  cursor: pointer;
}
.option:hover {
  background: #eef2f5;
}
.option.selected {
  background: #d9e8ff;
}
.correct {
  border-left: 6px solid green;
}
.wrong {
  border-left: 6px solid red;
}
.rationale {
  background: #f9fafb;
  border: 1px solid #ccc;
  padding: 15px;
  margin-top: 15px;
}
.report {
  background: #f1f5f9;
  padding: 20px;
  margin-top: 20px;
}
</style>
</head>

<body>
<div class="container">

<!-- START SCREEN -->
<div id="startScreen">
  <h1>SCFHS Pass Prediction Test</h1>
  <input type="text" id="candidateName" placeholder="Full Name">
  <input type="text" id="candidateID" placeholder="Candidate ID">
  <button onclick="startExam()">Start Test</button>
</div>

<!-- EXAM SCREEN -->
<div id="examScreen" class="hidden">
  <h2 id="qCounter"></h2>
  <p id="questionText"></p>
  <div id="options"></div>
  <button onclick="submitAnswer()">Submit Answer</button>

  <div id="rationaleBox" class="rationale hidden"></div>
  <button id="nextBtn" class="hidden" onclick="nextQuestion()">Next Question</button>
</div>

<!-- RESULT SCREEN -->
<div id="resultScreen" class="hidden">
  <h1>PASS PREDICTION RESULT</h1>
  <div id="finalReport" class="report"></div>
</div>

</div>

<script>
// ================= QUESTIONS =================

const questions = [
{
  q: "A patient states, â€œI plan to kill myself tonight,â€ and has access to a firearm. What is the nurseâ€™s PRIORITY action?",
  options: [
    { text: "Ensure immediate safety and initiate involuntary hold procedures", tag: "SCFHS" },
    { text: "Respect the patientâ€™s confidentiality", tag: "SAFE_DELAY" },
    { text: "Encourage the patient to reconsider", tag: "NCLEX" },
    { text: "Document the statement and continue assessment", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Expressed intent with means constitutes imminent danger requiring immediate protective action.",
    distractors: {
      SAFE_DELAY: "Confidentiality does not apply when life is at risk.",
      NCLEX: "Therapeutic communication cannot replace safety measures.",
      STR: "Documentation alone is insufficient."
    }
  }
},
{
  q: "A patient with acute psychosis is pacing and threatening staff but has not attempted harm. What is the nurseâ€™s FIRST intervention?",
  options: [
    { text: "Use verbal de-escalation techniques", tag: "SCFHS" },
    { text: "Apply physical restraints immediately", tag: "SAFE_DELAY" },
    { text: "Administer PRN antipsychotic medication", tag: "NCLEX" },
    { text: "Call security to restrain the patient", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Least-restrictive interventions must be attempted before restraints or medications.",
    distractors: {
      SAFE_DELAY: "Restraints are last-resort measures.",
      NCLEX: "Medication without de-escalation may violate rights.",
      STR: "Security escalates the situation prematurely."
    }
  }
},
{
  q: "A patient requests discharge from a psychiatric unit but is actively hallucinating and unable to care for self. What is the nurseâ€™s BEST response?",
  options: [
    { text: "Notify the provider to evaluate for involuntary hold", tag: "SCFHS" },
    { text: "Honor the discharge request immediately", tag: "SAFE_DELAY" },
    { text: "Ask the family to convince the patient to stay", tag: "NCLEX" },
    { text: "Document the request and take no action", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Inability to meet basic needs may justify involuntary commitment.",
    distractors: {
      SAFE_DELAY: "Discharge may result in harm.",
      NCLEX: "Family persuasion does not replace legal process.",
      STR: "Inaction violates duty to protect."
    }
  }
},
{
  q: "A patient under involuntary psychiatric hold requests to leave the unit. What should the nurse explain?",
  options: [
    { text: "The patient may not leave until legally released", tag: "SCFHS" },
    { text: "The hold overrides all patient rights", tag: "SAFE_DELAY" },
    { text: "The nurse will decide when discharge is safe", tag: "NCLEX" },
    { text: "The patient may leave if accompanied by family", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Involuntary hold restricts freedom of movement but not all rights.",
    distractors: {
      SAFE_DELAY: "Patients retain legal protections.",
      NCLEX: "Nurses do not determine legal release.",
      STR: "Family presence does not void a hold."
    }
  }
},
{
  q: "A patient threatens to harm a specific individual after discharge. What is the nurseâ€™s LEGAL duty?",
  options: [
    { text: "Report the threat according to duty-to-warn laws", tag: "SCFHS" },
    { text: "Maintain confidentiality", tag: "SAFE_DELAY" },
    { text: "Document the threat without reporting", tag: "NCLEX" },
    { text: "Ask the patient to sign a no-harm agreement", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Credible threats trigger a duty to protect potential victims.",
    distractors: {
      SAFE_DELAY: "Confidentiality is overridden by risk of harm.",
      NCLEX: "Documentation alone does not protect others.",
      STR: "Agreements have no legal force."
    }
  }
},
{
  q: "Which situation MOST justifies involuntary psychiatric commitment?",
  options: [
    { text: "Patient poses an immediate danger to self or others", tag: "SCFHS" },
    { text: "Patient refuses prescribed medication", tag: "SAFE_DELAY" },
    { text: "Patient displays unusual beliefs", tag: "NCLEX" },
    { text: "Patient is homeless and unemployed", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Imminent risk is the legal threshold for involuntary commitment.",
    distractors: {
      SAFE_DELAY: "Refusal alone is insufficient.",
      NCLEX: "Beliefs are protected unless dangerous.",
      STR: "Social issues do not justify commitment."
    }
  }
},
{
  q: "A patient calms after restraint application. What is the nurseâ€™s NEXT responsibility?",
  options: [
    { text: "Remove restraints as soon as it is safe", tag: "SCFHS" },
    { text: "Keep restraints until the end of shift", tag: "SAFE_DELAY" },
    { text: "Wait for family approval", tag: "NCLEX" },
    { text: "Document and leave restraints in place", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Restraints must be discontinued at the earliest safe opportunity.",
    distractors: {
      SAFE_DELAY: "Prolonged restraint violates patient rights.",
      NCLEX: "Family consent is not required.",
      STR: "Documentation does not justify continued restraint."
    }
  }
},
{
  q: "A nurse suspects a patient lacks decision-making capacity. What is the nurseâ€™s FIRST step?",
  options: [
    { text: "Notify the provider for formal evaluation", tag: "SCFHS" },
    { text: "Assume incapacity based on behavior", tag: "SAFE_DELAY" },
    { text: "Ask family to make decisions immediately", tag: "NCLEX" },
    { text: "Proceed with involuntary treatment", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Capacity determinations require formal evaluation.",
    distractors: {
      SAFE_DELAY: "Behavior alone does not determine capacity.",
      NCLEX: "Family involvement follows assessment.",
      STR: "Treatment without evaluation is unlawful."
    }
  }
},
{
  q: "A patient under involuntary hold refuses medication. What is the nurseâ€™s MOST appropriate action?",
  options: [
    { text: "Assess risk and follow legal process for forced medication", tag: "SCFHS" },
    { text: "Administer medication anyway", tag: "SAFE_DELAY" },
    { text: "Discharge the patient", tag: "NCLEX" },
    { text: "Threaten continued hospitalization", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Even involuntarily held patients retain rights regarding treatment unless legally overridden.",
    distractors: {
      SAFE_DELAY: "Forced medication without authorization is assault.",
      NCLEX: "Discharge may be unsafe.",
      STR: "Coercion violates ethical standards."
    }
  }
},
{
  q: "A patient expresses passive death wishes but denies intent or plan. What is the nurseâ€™s BEST action?",
  options: [
    { text: "Conduct further suicide risk assessment", tag: "SCFHS" },
    { text: "Initiate involuntary hold immediately", tag: "SAFE_DELAY" },
    { text: "Dismiss the statement as attention-seeking", tag: "NCLEX" },
    { text: "Document and end the conversation", tag: "STR" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Further assessment is needed when risk is unclear.",
    distractors: {
      SAFE_DELAY: "Hold requires imminent danger.",
      NCLEX: "Dismissal may miss escalation.",
      STR: "Ending assessment is unsafe."
    }
  }
}
];

// ================= ENGINE =================

let shuffledQuestions = [];
let currentIndex = 0;
let selectedOption = null;

let score = {
  SCFHS: 0,
  NCLEX: 0,
  STR: 0,
  SAFE_DELAY: 0
};

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function startExam() {
  const name = document.getElementById("candidateName").value.trim();
  const id = document.getElementById("candidateID").value.trim();
  if (!name || !id) {
    alert("Enter Name and ID");
    return;
  }

  shuffledQuestions = shuffle([...questions]);
  shuffledQuestions.forEach(q => q.options = shuffle(q.options));

  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");

  loadQuestion();
}

function loadQuestion() {
  selectedOption = null;
  document.getElementById("rationaleBox").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");

  const q = shuffledQuestions[currentIndex];
  document.getElementById("qCounter").innerText = `Question ${currentIndex + 1} of ${shuffledQuestions.length}`;
  document.getElementById("questionText").innerText = q.stem;

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";

  q.options.forEach((opt, index) => {
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = opt.text;
    div.onclick = () => selectOption(div, index);
    optionsDiv.appendChild(div);
  });
}

function selectOption(div, index) {
  document.querySelectorAll(".option").forEach(o => o.classList.remove("selected"));
  div.classList.add("selected");
  selectedOption = index;
}

function submitAnswer() {
  if (selectedOption === null) {
    alert("Select an option");
    return;
  }

  const q = shuffledQuestions[currentIndex];
  const rationaleBox = document.getElementById("rationaleBox");
  rationaleBox.classList.remove("hidden");

  const correctIndex = q.correct;
  const chosenTag = q.options[selectedOption].tag;
  score[chosenTag]++;

  let html = "";

  if (selectedOption === correctIndex) {
    html += "<b>Correct.</b><br><br>";
    html += q.rationale.correct;
  } else {
    html += "<b>Incorrect.</b><br><br>";
    html += q.rationale.distractors[selectedOption];
    html += "<hr><b>Correct Rationale:</b><br>" + q.rationale.correct;
  }

  rationaleBox.innerHTML = html;
  document.getElementById("nextBtn").classList.remove("hidden");
}

function nextQuestion() {
  currentIndex++;
  if (currentIndex < shuffledQuestions.length) {
    loadQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  let decision = score.SCFHS >= score.NCLEX && score.SCFHS >= score.STR
    ? "ðŸŸ¢ GO â€” SCFHS Ready"
    : "ðŸ”´ NO-GO â€” Not SCFHS Ready";

  let report = `
  <b>Decision:</b> ${decision}<br><br>
  <b>SCFHS Alignment:</b> ${score.SCFHS}<br>
  <b>NCLEX Bias:</b> ${score.NCLEX}<br>
  <b>STR Bias:</b> ${score.STR}<br><br>
  <b>Examiner Interpretation:</b><br>
  The response pattern indicates ${
    decision.includes("GO")
      ? "consistent prioritization aligned with SCFHS expectations."
      : "delayed or escalation-biased decision-making inconsistent with SCFHS Prometric standards."
  }
  `;

  document.getElementById("finalReport").innerHTML = report;
}
</script>

</body>
</html>
