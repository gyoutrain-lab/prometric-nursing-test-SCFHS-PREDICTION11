<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Pass Prediction Engine</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  margin: auto;
  background: #ffffff;
  padding: 20px;
  min-height: 100vh;
}
h1, h2 {
  text-align: center;
}
.hidden {
  display: none;
}
input, button {
  padding: 10px;
  margin: 5px 0;
  width: 100%;
  font-size: 16px;
}
.option {
  border: 1px solid #ccc;
  padding: 10px;
  margin-top: 8px;
  cursor: pointer;
}
.option:hover {
  background: #eef2f5;
}
.option.selected {
  background: #d9e8ff;
}
.correct {
  border-left: 6px solid green;
}
.wrong {
  border-left: 6px solid red;
}
.rationale {
  background: #f9fafb;
  border: 1px solid #ccc;
  padding: 15px;
  margin-top: 15px;
}
.report {
  background: #f1f5f9;
  padding: 20px;
  margin-top: 20px;
}
</style>
</head>

<body>
<div class="container">

<!-- START SCREEN -->
<div id="startScreen">
  <h1>SCFHS Pass Prediction Test</h1>
  <input type="text" id="candidateName" placeholder="Full Name">
  <input type="text" id="candidateID" placeholder="Candidate ID">
  <button onclick="startExam()">Start Test</button>
</div>

<!-- EXAM SCREEN -->
<div id="examScreen" class="hidden">
  <h2 id="qCounter"></h2>
  <p id="questionText"></p>
  <div id="options"></div>
  <button onclick="submitAnswer()">Submit Answer</button>

  <div id="rationaleBox" class="rationale hidden"></div>
  <button id="nextBtn" class="hidden" onclick="nextQuestion()">Next Question</button>
</div>

<!-- RESULT SCREEN -->
<div id="resultScreen" class="hidden">
  <h1>PASS PREDICTION RESULT</h1>
  <div id="finalReport" class="report"></div>
</div>

</div>

<script>
// ================= QUESTIONS =================

const questions = [
{
  stem: "A 68-year-old male admitted with pneumonia becomes acutely restless 30 minutes after admission. BP 88/54 mmHg, HR 124 bpm, RR 30/min, SpOâ‚‚ 89% on room air. Crackles are audible bilaterally.",
  options: [
    { text: "Notify the physician of the patient's condition", tag: "STR" },
    { text: "Elevate the head of the bed to 45 degrees", tag: "SAFE_DELAY" },
    { text: "Initiate supplemental oxygen therapy", tag: "SCFHS" },
    { text: "Prepare for possible intubation", tag: "NCLEX" }
  ],
  correct: 2,
  rationale: {
    correct: "Although notifying the physician is appropriate, the patient demonstrates signs of impaired gas exchange with hypoxia requiring immediate nursing intervention. Elevating the head of the bed may improve ventilation; however, supplemental oxygen directly addresses hypoxia. Therefore, initiating oxygen therapy is the most appropriate first action.",
    distractors: [
      "This reflects escalation of care and aligns with STR protocols; however, SCFHS prioritizes immediate stabilization before notification.",
      "This intervention may support ventilation but does not directly correct hypoxia.",
      "This anticipates deterioration but bypasses immediate nursing actions required first."
    ]
  }
},

{
  stem: "A postoperative patient reports increasing pain and appears anxious. BP 156/94 mmHg, HR 112 bpm. Surgical dressing is dry and intact.",
  options: [
    { text: "Administer prescribed analgesic medication", tag: "SCFHS" },
    { text: "Reassure the patient and encourage deep breathing", tag: "SAFE_DELAY" },
    { text: "Notify the surgeon of elevated blood pressure", tag: "STR" },
    { text: "Assess the surgical site for bleeding", tag: "NCLEX" }
  ],
  correct: 0,
  rationale: {
    correct: "Although further assessment and notification may be appropriate, the patient exhibits physiologic responses consistent with uncontrolled pain. Administering prescribed analgesia directly addresses the underlying cause, making it the most appropriate first action.",
    distractors: [
      "This supports comfort but does not address the primary cause of distress.",
      "This represents escalation but delays symptom control.",
      "Assessment is reasonable; however, no evidence suggests active bleeding."
    ]
  }
},
{
  critical:true,
  stem:"A 68-year-old male with pneumonia becomes restless 20 minutes after admission. BP 88/54, HR 124, RR 30, SpOâ‚‚ 89% on room air.",
  options:[
    {t:"Notify the physician immediately", tag:"ESCALATION"},
    {t:"Elevate the head of the bed", tag:"DELAY"},
    {t:"Initiate supplemental oxygen therapy", tag:"SCFHS"},
    {t:"Prepare intubation equipment", tag:"ANTICIPATION"}
  ],
  correct:2,
  rationale:{
    correct:"Although notifying the physician and preparing for advanced airway support may be appropriate, the patient demonstrates acute hypoxia requiring immediate nursing intervention. Supplemental oxygen directly addresses impaired gas exchange, whereas other actions may delay correction of hypoxia. Therefore, initiating oxygen therapy is the most appropriate first action.",
    options:[
      "This reflects escalation bias. SCFHS expects stabilization before notification.",
      "This may improve ventilation but does not directly correct hypoxia.",
      "Correct â€” this action immediately addresses the life-threatening problem.",
      "This anticipates deterioration but bypasses required immediate intervention."
    ]
  }
},
{
  critical:false,
  stem:"A postoperative patient reports severe incisional pain. BP 158/96, HR 110. Surgical dressing is clean and dry.",
  options:[
    {t:"Administer prescribed analgesic", tag:"SCFHS"},
    {t:"Reassure and encourage relaxation", tag:"DELAY"},
    {t:"Notify the surgeon of hypertension", tag:"ESCALATION"},
    {t:"Reassess the surgical site", tag:"ASSESS"}
  ],
  correct:0,
  rationale:{
    correct:"Although further assessment and provider notification may be appropriate, the patient's physiological response indicates uncontrolled pain. Administering prescribed analgesia directly addresses the underlying cause and is the most appropriate first action.",
    options:[
      "Correct â€” this treats the root cause of the instability.",
      "This provides comfort but delays symptom control.",
      "This escalates care unnecessarily before intervention.",
      "Assessment is reasonable but no signs indicate complications."
    ]
  }
}

];

// ================= ENGINE =================

let shuffledQuestions = [];
let currentIndex = 0;
let selectedOption = null;

let score = {
  SCFHS: 0,
  NCLEX: 0,
  STR: 0,
  SAFE_DELAY: 0
};

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function startExam() {
  const name = document.getElementById("candidateName").value.trim();
  const id = document.getElementById("candidateID").value.trim();
  if (!name || !id) {
    alert("Enter Name and ID");
    return;
  }

  shuffledQuestions = shuffle([...questions]);
  shuffledQuestions.forEach(q => q.options = shuffle(q.options));

  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");

  loadQuestion();
}

function loadQuestion() {
  selectedOption = null;
  document.getElementById("rationaleBox").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");

  const q = shuffledQuestions[currentIndex];
  document.getElementById("qCounter").innerText = `Question ${currentIndex + 1} of ${shuffledQuestions.length}`;
  document.getElementById("questionText").innerText = q.stem;

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";

  q.options.forEach((opt, index) => {
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = opt.text;
    div.onclick = () => selectOption(div, index);
    optionsDiv.appendChild(div);
  });
}

function selectOption(div, index) {
  document.querySelectorAll(".option").forEach(o => o.classList.remove("selected"));
  div.classList.add("selected");
  selectedOption = index;
}

function submitAnswer() {
  if (selectedOption === null) {
    alert("Select an option");
    return;
  }

  const q = shuffledQuestions[currentIndex];
  const rationaleBox = document.getElementById("rationaleBox");
  rationaleBox.classList.remove("hidden");

  const correctIndex = q.correct;
  const chosenTag = q.options[selectedOption].tag;
  score[chosenTag]++;

  let html = "";

  if (selectedOption === correctIndex) {
    html += "<b>Correct.</b><br><br>";
    html += q.rationale.correct;
  } else {
    html += "<b>Incorrect.</b><br><br>";
    html += q.rationale.distractors[selectedOption];
    html += "<hr><b>Correct Rationale:</b><br>" + q.rationale.correct;
  }

  rationaleBox.innerHTML = html;
  document.getElementById("nextBtn").classList.remove("hidden");
}

function nextQuestion() {
  currentIndex++;
  if (currentIndex < shuffledQuestions.length) {
    loadQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  let decision = score.SCFHS >= score.NCLEX && score.SCFHS >= score.STR
    ? "ðŸŸ¢ GO â€” SCFHS Ready"
    : "ðŸ”´ NO-GO â€” Not SCFHS Ready";

  let report = `
  <b>Decision:</b> ${decision}<br><br>
  <b>SCFHS Alignment:</b> ${score.SCFHS}<br>
  <b>NCLEX Bias:</b> ${score.NCLEX}<br>
  <b>STR Bias:</b> ${score.STR}<br><br>
  <b>Examiner Interpretation:</b><br>
  The response pattern indicates ${
    decision.includes("GO")
      ? "consistent prioritization aligned with SCFHS expectations."
      : "delayed or escalation-biased decision-making inconsistent with SCFHS Prometric standards."
  }
  `;

  document.getElementById("finalReport").innerHTML = report;
}
</script>

</body>
</html>
