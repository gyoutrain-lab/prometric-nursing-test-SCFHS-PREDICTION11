<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Pass Prediction Engine</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  margin: auto;
  background: #ffffff;
  padding: 20px;
  min-height: 100vh;
}
h1, h2 {
  text-align: center;
}
.hidden {
  display: none;
}
input, button {
  padding: 10px;
  margin: 5px 0;
  width: 100%;
  font-size: 16px;
}
.option {
  border: 1px solid #ccc;
  padding: 10px;
  margin-top: 8px;
  cursor: pointer;
}
.option:hover {
  background: #eef2f5;
}
.option.selected {
  background: #d9e8ff;
}
.correct {
  border-left: 6px solid green;
}
.wrong {
  border-left: 6px solid red;
}
.rationale {
  background: #f9fafb;
  border: 1px solid #ccc;
  padding: 15px;
  margin-top: 15px;
}
.report {
  background: #f1f5f9;
  padding: 20px;
  margin-top: 20px;
}
</style>
</head>

<body>
<div class="container">

<!-- START SCREEN -->
<div id="startScreen">
  <h1>SCFHS Pass Prediction Test</h1>
  <input type="text" id="candidateName" placeholder="Full Name">
  <input type="text" id="candidateID" placeholder="Candidate ID">
  <button onclick="startExam()">Start Test</button>
</div>

<!-- EXAM SCREEN -->
<div id="examScreen" class="hidden">
  <h2 id="qCounter"></h2>
  <p id="questionText"></p>
  <div id="options"></div>
  <button onclick="submitAnswer()">Submit Answer</button>

  <div id="rationaleBox" class="rationale hidden"></div>
  <button id="nextBtn" class="hidden" onclick="nextQuestion()">Next Question</button>
</div>

<!-- RESULT SCREEN -->
<div id="resultScreen" class="hidden">
  <h1>PASS PREDICTION RESULT</h1>
  <div id="finalReport" class="report"></div>
</div>

</div>

<script>
// ================= QUESTIONS =================

const questions = [
{
  stem: "A 68-year-old male admitted with pneumonia becomes acutely restless 30 minutes after admission. BP 88/54 mmHg, HR 124 bpm, RR 30/min, SpOâ‚‚ 89% on room air. Crackles are audible bilaterally.",
  options: [
    { text: "Notify the physician of the patient's condition", tag: "STR" },
    { text: "Elevate the head of the bed to 45 degrees", tag: "SAFE_DELAY" },
    { text: "Initiate supplemental oxygen therapy", tag: "SCFHS" },
    { text: "Prepare for possible intubation", tag: "NCLEX" }
  ],
  correct: 2,
  rationale: {
    correct: "Although notifying the physician is appropriate, the patient demonstrates signs of impaired gas exchange with hypoxia requiring immediate nursing intervention. Elevating the head of the bed may improve ventilation; however, supplemental oxygen directly addresses hypoxia. Therefore, initiating oxygen therapy is the most appropriate first action.",
    distractors: [
      "This reflects escalation of care and aligns with STR protocols; however, SCFHS prioritizes immediate stabilization before notification.",
      "This intervention may support ventilation but does not directly correct hypoxia.",
      "This anticipates deterioration but bypasses immediate nursing actions required first."
    ]
  }
},

{
  stem: "A 64-year-old male with COPD becomes increasingly drowsy after receiving morphine. RR 8/min, SpOâ‚‚ 91% on room air.",
  options: [
    { text: "Notify the physician immediately", tag: "STR" },
    { text: "Apply supplemental oxygen", tag: "SAFE_DELAY" },
    { text: "Assess respiratory effort and level of consciousness", tag: "SCFHS" },
    { text: "Prepare naloxone for possible administration", tag: "NCLEX" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Although opioid reversal and provider notification may be required, the patient demonstrates signs of respiratory depression requiring immediate nursing assessment. Evaluating respiratory effort and level of consciousness guides appropriate intervention, making this the most appropriate first action.",
    distractors: {
      STR: "This reflects escalation of care but delays immediate nursing assessment expected by SCFHS.",
      SAFE_DELAY: "Oxygen does not correct hypoventilation and may worsen carbon dioxide retention.",
      NCLEX: "Preparing reversal anticipates deterioration but bypasses the required first assessment."
    }
  }
},

{
  stem: "A postoperative patient suddenly develops stridor and agitation 30 minutes after extubation.",
  options: [
    { text: "Apply oxygen via face mask", tag: "SCFHS" },
    { text: "Notify anesthesia immediately", tag: "STR" },
    { text: "Place the patient in a supine position", tag: "SAFE_DELAY" },
    { text: "Prepare emergency airway equipment", tag: "NCLEX" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Although airway equipment preparation and provider notification are appropriate, the patient demonstrates acute airway compromise. Immediate oxygen administration supports oxygenation while further interventions are initiated, making this the most appropriate first action.",
    distractors: {
      STR: "Notification delays immediate stabilization.",
      SAFE_DELAY: "Supine positioning may worsen airway obstruction.",
      NCLEX: "Preparation is appropriate but secondary to immediate oxygen support."
    }
  }
},

{
  stem: "A patient with sepsis has BP 84/48 mmHg, HR 122 bpm, and urine output of 15 mL/hr.",
  options: [
    { text: "Increase IV fluids as prescribed", tag: "SCFHS" },
    { text: "Notify the physician of hypotension", tag: "STR" },
    { text: "Insert a Foley catheter", tag: "NCLEX" },
    { text: "Document intake and output", tag: "SAFE_DELAY" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Although provider notification and further assessment are appropriate, the patient demonstrates hypoperfusion. Increasing IV fluids as prescribed directly supports circulation and is the most appropriate immediate nursing action.",
    distractors: {
      STR: "Escalation without intervention delays stabilization.",
      NCLEX: "Assessment is secondary to restoring perfusion.",
      SAFE_DELAY: "Documentation does not address shock."
    }
  }
},

{
  stem: "A diabetic patient becomes confused and diaphoretic. Capillary glucose is 38 mg/dL.",
  options: [
    { text: "Administer IV dextrose", tag: "SCFHS" },
    { text: "Notify the physician immediately", tag: "STR" },
    { text: "Recheck blood glucose in 15 minutes", tag: "SAFE_DELAY" },
    { text: "Document the findings", tag: "SAFE_DELAY" }
  ],
  correctTag: "SCFHS",
  rationale: {
    correct: "Although provider notification is appropriate, the patient demonstrates symptomatic hypoglycemia requiring immediate correction. Administering IV dextrose rapidly restores glucose levels and prevents neurologic injury.",
    distractors: {
      STR: "Notification delays treatment.",
      SAFE_DELAY: "Delays correction of a life-threatening condition."
    }
  }
}

];

// ================= ENGINE =================

let shuffledQuestions = [];
let currentIndex = 0;
let selectedOption = null;

let score = {
  SCFHS: 0,
  NCLEX: 0,
  STR: 0,
  SAFE_DELAY: 0
};

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function startExam() {
  const name = document.getElementById("candidateName").value.trim();
  const id = document.getElementById("candidateID").value.trim();
  if (!name || !id) {
    alert("Enter Name and ID");
    return;
  }

  shuffledQuestions = shuffle([...questions]);
  shuffledQuestions.forEach(q => q.options = shuffle(q.options));

  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("examScreen").classList.remove("hidden");

  loadQuestion();
}

function loadQuestion() {
  selectedOption = null;
  document.getElementById("rationaleBox").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");

  const q = shuffledQuestions[currentIndex];
  document.getElementById("qCounter").innerText = `Question ${currentIndex + 1} of ${shuffledQuestions.length}`;
  document.getElementById("questionText").innerText = q.stem;

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";

  q.options.forEach((opt, index) => {
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = opt.text;
    div.onclick = () => selectOption(div, index);
    optionsDiv.appendChild(div);
  });
}

function selectOption(div, index) {
  document.querySelectorAll(".option").forEach(o => o.classList.remove("selected"));
  div.classList.add("selected");
  selectedOption = index;
}

function submitAnswer() {
  if (selectedOption === null) {
    alert("Select an option");
    return;
  }

  const q = shuffledQuestions[currentIndex];
  const rationaleBox = document.getElementById("rationaleBox");
  rationaleBox.classList.remove("hidden");

  const correctIndex = q.correct;
  const chosenTag = q.options[selectedOption].tag;
  score[chosenTag]++;

  let html = "";

  if (selectedOption === correctIndex) {
    html += "<b>Correct.</b><br><br>";
    html += q.rationale.correct;
  } else {
    html += "<b>Incorrect.</b><br><br>";
    html += q.rationale.distractors[selectedOption];
    html += "<hr><b>Correct Rationale:</b><br>" + q.rationale.correct;
  }

  rationaleBox.innerHTML = html;
  document.getElementById("nextBtn").classList.remove("hidden");
}

function nextQuestion() {
  currentIndex++;
  if (currentIndex < shuffledQuestions.length) {
    loadQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  document.getElementById("examScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  let decision = score.SCFHS >= score.NCLEX && score.SCFHS >= score.STR
    ? "ðŸŸ¢ GO â€” SCFHS Ready"
    : "ðŸ”´ NO-GO â€” Not SCFHS Ready";

  let report = `
  <b>Decision:</b> ${decision}<br><br>
  <b>SCFHS Alignment:</b> ${score.SCFHS}<br>
  <b>NCLEX Bias:</b> ${score.NCLEX}<br>
  <b>STR Bias:</b> ${score.STR}<br><br>
  <b>Examiner Interpretation:</b><br>
  The response pattern indicates ${
    decision.includes("GO")
      ? "consistent prioritization aligned with SCFHS expectations."
      : "delayed or escalation-biased decision-making inconsistent with SCFHS Prometric standards."
  }
  `;

  document.getElementById("finalReport").innerHTML = report;
}
</script>

</body>
</html>
